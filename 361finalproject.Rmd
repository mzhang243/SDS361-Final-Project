---
title: "S&DS361 Final Project"
author: "Arthur Cao, Gandhar Mahadeshwar, Megan Zhang"
output: html_notebook
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(readxl)
library(MASS)
library(tidyverse)
library(dplyr)
library(class)
```

```{r}
#change path
dataset <- read_excel("/Users/gandharmahadeshwar/Desktop/MB&B471 Notes/1Mg2Mn_18S/1Mg2Mn_18S_human_18S_profile.xlsx")
View(dataset)

#modifications and positions extracted from 3D Modifications U of Albany database
mods <- c("Am", "pseu", "pseu", "pseu", "Am", "pseu", "pseu", "Um", "pseu", 
          "Um", "Am", "Am", "Um", "Cm", "pseu", "pseu", "pseu", "Um", "Gm", 
          "Cm", "Am", "Am", "Gm", "Am", "Cm", "pseu", "Am", "Am", "Gm", "pseu",
          "Um", "Gm", "pseu", "pseu", "Am", "pseu", "Gm", "pseu", "Cm", "Um", 
          "pseu", "pseu", "pseu", "pseu", "pseu", "pseu", "Gm", "pseu", "pseu", 
          "pseu", "Am", "pseu", "pseu", "pseu", "pseu", "pseu", "m1acp3Y", "Cm", 
          "Um", "pseum", "Gm", "pseu", "pseu", "Am", "Cm", "Um", "pseu", "Gm", 
          "pseu", "m7G", "pseu", "Am", "pseu", "Cm", "Um", "m6A", "m62A", "m62A")

nums <- c(27, 44, 46, 93, 99, 105, 109, 116, 119, 121, 159, 166, 172, 174, 210,
          218, 406, 428, 436, 462, 468, 484, 509, 512, 517, 572, 576, 590, 601, 
          609, 627, 644, 659, 651, 668, 681, 683, 686, 797, 799, 801, 814, 815,
          822, 863, 866, 867, 918, 966, 1004, 1031, 1056, 1081, 1174, 1238, 1244, 
          1248, 1272, 1288, 1326, 1328, 1347, 1367, 1383, 1391, 1442, 1445, 1490,
          1625, 1639, 1643, 1678, 1692, 1703, 1804, 1832, 1850, 1851)

#intersperse modifications with labels of "none" to create a vector with same size as dataset
modvector <- rep("none", dim(dataset)[1])
k <- 1
for (h in nums) {
  modvector[h] <- mods[k]
  k <- k + 1
}

#bind vector of modifications onto the beginning of our dataset
new <- cbind(modvector, dataset)

#now, we remove the unnecessary columns (cataloguing information we are not going to use)
#also, renaming columns for clarity (...modified... -> ...Mn...)
new.filtered <- new %>% select(-ends_with("mapped_depth")) %>% select(-ends_with("read_depth")) %>% 
  select(-starts_with("Denatured")) %>% select(-ends_with("profile")) %>% select(-ends_with("err")) %>%
  rename(
    Mn_mutations = Modified_mutations,
    Mn_effective_depth = Modified_effective_depth,
    Mn_rate = Modified_rate,
    Modifications = modvector
    )

#our updated and filtered dataset
new.filtered
